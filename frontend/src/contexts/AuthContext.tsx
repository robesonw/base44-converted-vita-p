import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { apiFetch } from '../lib/api';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(() => localStorage.getItem('token'));\n  const navigate = useNavigate();\n\n  const login = async (email, password) => {\n    const response = await apiFetch('POST', '/auth/login', { email, password });\n    setUser(response.user);\n    setToken(response.token);\n    localStorage.setItem('token', response.token);\n    navigate('/');\n  };\n\n  const logout = () => {\n    setUser(null);\n    setToken(null);\n    localStorage.removeItem('token');\n    navigate('/login');\n  };\n\n  const autoRefresh = () => {\n    const tokenExpiry = new Date(localStorage.getItem('tokenExpiry'));\n    if (tokenExpiry && tokenExpiry <= new Date()) {\n      logout();\n    }\n  };\n\n  useEffect(() => {\n    const interval = setInterval(autoRefresh, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);